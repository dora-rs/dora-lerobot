nodes:
  - id: teleop
    custom:
      source: /home/thomwolf/miniconda3/envs/dora/bin/python
      args: ../nodes/teleop_python.py
      inputs:
        heartbeat: dora/timer/millis/20
      outputs:
        - puppet_position
        - puppet_velocity
        - puppet_goal_position
      envs:
        MASTER_PATH: /dev/ttyACM1
        PUPPET_PATH: /dev/ttyACM0
        STRENGTH: 70

  - id: cam_low
    custom:
      source: /home/thomwolf/miniconda3/envs/dora/bin/python
      args: ../nodes/webcam.py
      inputs:
        tick: dora/timer/millis/20
      outputs:
        - image
      envs:
        CAMERA_ID: /dev/video0

  - id: cam_high
    custom:
      source: /home/thomwolf/miniconda3/envs/dora/bin/python
      args: ../nodes/webcam.py
      inputs:
        tick: dora/timer/millis/20
      outputs:
        - image
      envs:
        CAMERA_ID: /dev/video6

  - id: dora-record
    custom:
      build: cargo install --git https://github.com/dora-rs/dora dora-record
      source: dora-record
      inputs:
        action: teleop/puppet_goal_position
        observation.state: teleop/puppet_position
        observation.velocity: teleop/puppet_velocity
        episode_index: keyboard/space
        failed_episode_index: keyboard/failed
        observation.images.cam_low: cam_saver_low/saved_image
        observation.images.cam_high: cam_saver_high/saved_image

  - id: keyboard
    custom: 
      source: ../nodes/keyboard_node_basic.py
      inputs:
        heartbeat: dora/timer/millis/20
      outputs:
        - space
        - failed

  - id: cam_saver_low
    custom:
      source: ../nodes/lerobot_webcam_saver_basic.py
      inputs:
        image: cam_low/image
        record_episode: keyboard/space
      outputs:
        - saved_image
      envs:
        CAMERA_NAME: observation.images.cam_low

  - id: cam_saver_high
    custom:
      source: ../nodes/lerobot_webcam_saver_basic.py
      inputs:
        image: cam_high/image
        record_episode: keyboard/space
      outputs:
        - saved_image
      envs:
        CAMERA_NAME: observation.images.cam_high
