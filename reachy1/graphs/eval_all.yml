nodes:
  - id: reachy-client
    custom:
      source: ../nodes/reachy_client.py
      inputs:
        # action: eval/action
        tick: dora/timer/millis/33
      outputs:
        - agent_pos

  - id: reachy-vision-client
    custom:
      source: ../nodes/reachy_vision_client.py
      inputs:
        tick: dora/timer/millis/33
      outputs:
        - cam_trunk

  - id: eval
    custom:
      # source: dynamic
      source: /home/peter/Documents/work/lerobot/lerobot/scripts/eval.py
      args: -p /home/peter/Documents/work/lerobot/high_five_sea_3/checkpoints/last/pretrained_model eval.n_episodes=1 eval.batch_size=1 env.episode_length=200000 policy.n_action_steps=100
      # source: ../nodes/gym_dora_node.py
      inputs:
        agent_pos: reachy-client/agent_pos
        cam_trunk: reachy-vision-client/cam_trunk
        start_high_five: parler/start_high_five
      outputs:
        - action

  - id: plot
    custom:
      source: ../nodes/plot_node.py
      inputs:
        image: reachy-vision-client/cam_trunk
        action: eval/action
        text_vlm: idefics2/speak
        text_whisper: whisper/text_llm
      envs:
        IMAGE_WIDTH: 480
        IMAGE_HEIGHT: 640

  - id: idefics2
    custom:
      source: ../nodes/idefics2_node_demo.py
      inputs:
        image:
          source: reachy-vision-client/cam_trunk
          queue_size: 1
        text: whisper/text_llm
      outputs:
        - speak
        - control

  - id: whisper
    custom:
      source: ../nodes/whisper_node.py
      inputs:
        audio: dora/timer/millis/1000
      outputs:
        - text_llm

  - id: parler
    custom:
      source: ../nodes/parler_node.py
      inputs:
        text: idefics2/speak
      outputs:
        - start_high_five
